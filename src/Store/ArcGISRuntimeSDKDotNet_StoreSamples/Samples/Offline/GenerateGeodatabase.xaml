<Page
    x:Class="ArcGISRuntimeSDKDotNet_StoreSamples.Samples.GenerateGeodatabase"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:common="using:ArcGISRuntimeSDKDotNet_StoreSamples.Common"
    xmlns:esri="using:Esri.ArcGISRuntime.Controls"
    xmlns:lyr="using:Esri.ArcGISRuntime.Layers"
    xmlns:geo="using:Esri.ArcGISRuntime.Geometry"
    xmlns:sym="using:Esri.ArcGISRuntime.Symbology"
    xmlns:data="using:Esri.ArcGISRuntime.Data">

    <Grid x:Name="LayoutRoot" Background="{ThemeResource ApplicationPageBackgroundThemeBrush}">
        <Grid.Resources>
            <sym:SimpleFillSymbol x:Key="AOISymbol" Color="#55FF0000" Style="Solid" />
            <sym:SimpleRenderer x:Key="AOIRenderer" Symbol="{StaticResource AOISymbol}" />

            <Style TargetType="ListViewItem">
                <Setter Property="HorizontalContentAlignment" Value="Stretch" />
            </Style>

            <DataTemplate x:Key="legendItemTemplate">
                <StackPanel Orientation="Horizontal">
                    <CheckBox IsChecked="{Binding IsVisible, Mode=TwoWay}" Margin="0,0,8,0" />
                    <TextBlock Text="{Binding DisplayName}" FontSize="16" VerticalAlignment="Center"/>
                </StackPanel>
            </DataTemplate>

            <DataTemplate x:Key="legendGroupTemplate">
                <StackPanel>
                    <ContentPresenter ContentTemplate="{StaticResource legendItemTemplate}" />
                    <ItemsControl ItemsSource="{Binding ChildLayers}" Margin="30,0,0,0"
                                  ItemTemplate="{StaticResource legendItemTemplate}" />
                </StackPanel>
            </DataTemplate>
        </Grid.Resources>

        <esri:MapView x:Name="mapView">
            <esri:Map>
                <lyr:ArcGISTiledMapServiceLayer DisplayName="Streets Basemap"
                    ServiceUri="http://server.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer" />

                <lyr:ArcGISDynamicMapServiceLayer ID="onlineService" DisplayName="Online Data"
                    ServiceUri="http://sampleserver6.arcgisonline.com/arcgis/rest/services/Sync/WildfireSync/MapServer" />
            </esri:Map>
        </esri:MapView>

        <Border Background="#CC000000" HorizontalAlignment="Right" VerticalAlignment="Top" Margin="30" Padding="20" Width="375">
            <StackPanel>
                <TextBlock Text="Click 'Generate Local Geodatabase' to download a geodatabase from the online feature service." TextWrapping="Wrap" />
                <Button Content="Generate Local Geodatabase" Margin="12" HorizontalAlignment="Stretch" Click="GenerateGeodatabaseButton_Click" />

                <StackPanel x:Name="panelStatus" Margin="0,12,0,0" Visibility="Collapsed">
                    <TextBlock x:Name="txtStatus" HorizontalAlignment="Center" />
                    <ProgressBar x:Name="progress" IsIndeterminate="True" Margin="24,12"/>
                </StackPanel>

                <TextBlock Text="Map Layers" FontSize="16" FontWeight="Bold" Margin="0,12,0,6" />
                <ItemsControl Grid.Row="1" ItemsSource="{Binding ElementName=mapView, Path=Map.Layers}" 
                          ItemTemplate="{StaticResource legendGroupTemplate}" />
            </StackPanel>
        </Border>
    </Grid>
</Page>
